<div class="column-selection-dialog">
  <h2 mat-dialog-title>Select Columns for Export</h2>

  <mat-dialog-content class="scrollable-content">
    <div class="dialog-content">
      <p class="description">
        Select the columns you want to include in the Excel file.
      </p>

      <div class="action-buttons">
        <button mat-button type="button" (click)="selectAll()" color="primary">
          Select All
        </button>
        <button
          mat-button
          type="button"
          (click)="deselectAll()"
          color="primary">
          Deselect All
        </button>
        <span class="selected-count">
          {{ selectedCount }} of {{ columns.length }} selected
        </span>
      </div>

      <div class="columns-list">
        @for (column of columns; track column.key) {
          <div class="column-item">
            <mat-checkbox
              [(ngModel)]="column.selected"
              [id]="'column-' + column.key">
              {{ column.label }}
            </mat-checkbox>
          </div>
        }
      </div>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button class="cancel-button" type="button" (click)="onCancel()">
      Cancel
    </button>
    <button
      mat-button
      class="generate-button"
      type="button"
      [disabled]="selectedCount === 0"
      (click)="onGenerate()">
      Generate Excel
    </button>
  </mat-dialog-actions>
</div>

